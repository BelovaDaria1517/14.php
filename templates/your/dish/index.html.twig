{% extends 'base.html.twig' %}

{% block title %}Блюда - Ресторан{% endblock %}

{% block page_title %}Управление меню{% endblock %}

{% block content %}
    <h2>Список блюд</h2>
    
    <div>
        <a href="{{ path('app_dish_new') }}">Добавить блюдо</a>
        <a href="{{ path('app_dish_export_excel') }}">Экспорт в Excel</a>
    </div>

    <table border="1">
        <thead>
            <tr>
                <th>Фото</th>
                <th>Название</th>
                <th>Цена</th>
                <th>Заказов</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
        {% for dish in dishes %}
            <tr>
                <td>
                    {% if dish.hasImage %}
                        <img src="{{ vich_uploader_asset(dish, 'imageFile') }}" alt="{{ dish.name }}" width="50">
                    {% else %}
                        <img src="{{ asset('images/placeholder.jpg') }}" alt="Заглушка" width="50">
                    {% endif %}
                </td>
                <td>{{ dish.name }}</td>
                <td>{{ dish.price }} руб.</td>
                <td>{{ dish.orders|length }}</td>
                <td>
                    <a href="{{ path('app_dish_show', {'id': dish.id}) }}">Просмотр</a>
                    <a href="{{ path('app_dish_edit', {'id': dish.id}) }}">Редактировать</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="5">Блюда не найдены</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}